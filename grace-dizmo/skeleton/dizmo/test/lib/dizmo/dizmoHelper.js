Class('DizmoHelper.Presentation.Controller',{my:{has:{initialized:{is:'rw',init:false},stepCallback:{is:'rw',init:null,setterName:'onStep'},nextStepCallback:{is:'rw',init:null,setterName:'onNextStep'},previousStepCallback:{is:'rw',init:null,setterName:'onPreviousStep'},lastStepCallback:{is:'rw',init:null,setterName:'onLastStep'},firstStepCallback:{is:'rw',init:null,setterName:'onFirstStep'},animationChangedCallback:{is:'rw',init:null,setterName:'onAnimationChanged'},globalTimerStoppedCallback:{is:'rw',init:null,setterName:'onGlobalTimerStopped'},globalTimerStartedCallback:{is:'rw',init:null,setterName:'onGlobalTimerStarted'}},methods:{init:function(){var a=this;if(a.getInitialized())return;dizmo.publicStorage().setProperty('presentation/totalSteps','0');dizmo.publicStorage().setProperty('presentation/step','0');dizmo.publicStorage().setProperty('presentation/animationRunning','false');dizmo.publicStorage().setProperty('presentation/globalTimerRunning','false');dizmo.publicStorage().setProperty('presentation/hasGlobalTimer','false');a.initEvents();a.setInitialized(true);},initEvents:function(){var a=this;var b=dizmo.publicStorage();b.subscribeTo('presentation/step',function(b,c,d){var e;step=parseInt(c);oldStep=parseInt(d);var f=dizmo.publicStorage().getProperty('presentation/totalSteps');f=parseInt(f);if(isNaN(step)||isNaN(f))return;if(step>f||step<1)return;if(isNaN(oldStep))oldStep=1;e=a.getStepCallback();if(typeof e==='function')e.call(a,step,oldStep);if(step===1){e=a.getFirstStepCallback();if(typeof e==='function')e.call(a,step,oldStep);return;}if(step>=f){e=a.getLastStepCallback();if(typeof e==='function')e.call(a,step,oldStep);return;}if(step<oldStep){e=a.getPreviousStepCallback();if(typeof e==='function')e.call(a,step,oldStep);return;}if(step>oldStep){e=a.getNextStepCallback();if(typeof e==='function')e.call(a,step,oldStep);return;}});b.subscribeTo('presentation/animationRunning',function(b,c,d){var e=a.getAnimationChangedCallback();if(typeof d==='undefined')d='false';if(d!=='true'&&d!=='false'){d='false';return;}if(d===c)return;if(c==='true'){if(typeof e==='function')e.call(a,'finished');}else if(c==='false'){if(typeof e==='function')e.call(a,'started');}else console.log('The set animation value is wrong. It should be either true or false.');});b.subscribeTo('presentation/globalTimerRunning',function(b,c,d){if(dizmo.publicStorage().getProperty('presentation/hasGlobalTimer')!=='true'){console.log('You have to enable the global timer first!');return;}var e=a.getGlobalTimerStoppedCallback();var f=a.getGlobalTimerStartedCallback();if(typeof d==='undefined')d='false';if(d!=='true'&&d!=='false'){d='false';return;}if(d===c)return;if(c==='false'){if(typeof e==='function')e.call(a);}else if(c==='true'){if(typeof f==='function')f.call(a);}else{console.log('The global timer flag value is wrong. It should be either true or false.');return;}});},onStep:function(a){var b=this;if(typeof a!=='function'){console.log('Please provide a function as the onStep callback!');return;}b.stepCallback=a;},onFirstStep:function(a){var b=this;if(typeof a!=='function'){console.log('Please provide a function as the onFirstStep callback!');return;}b.firstStepCallback=a;},onPreviousStep:function(a){var b=this;if(typeof a!=='function'){console.log('Please provide a function as the onPreviousStep callback!');return;}b.previousStepCallback=a;},onNextStep:function(a){var b=this;if(typeof a!=='function'){console.log('Please provide a function as the onNextStep callback!');return;}b.nextStepCallback=a;},onLastStep:function(a){var b=this;if(typeof a!=='function'){console.log('Please provide a function as the onLastStep callback!');return;}b.lastStepCallback=a;},onAnimationChanged:function(a){var b=this;if(typeof a!=='function'){console.log('Please provide a function as the onAnimationChanged callback!');return;}b.animationChangedCallback=a;},onGlobalTimerStarted:function(a){var b=this;if(typeof a!=='function'){console.log('Please provide a function as the onGlobalTimerStarted callback!');return;}b.globalTimerStartedCallback=a;},onGlobalTimerStopped:function(a){var b=this;if(typeof a!=='function'){console.log('Please provide a function as the onGlobalTimerStopped callback!');return;}b.globalTimerStoppedCallback=a;},setTotalSteps:function(a){a=parseInt(a);if(isNaN(a))throw {'name':'NotANumberError','message':'Please provide a number as the total steps!'};dizmo.publicStorage().setProperty('presentation/totalSteps',a.toString());},getTotalSteps:function(){var a=dizmo.publicStorage().getProperty('presentation/totalSteps');a=parseInt(a);if(isNaN(a))return 0;return a;},setStep:function(a){a=parseInt(a);if(isNaN(a))throw {'name':'NotANumberError','message':'Please provide a number as a step!'};dizmo.publicStorage().setProperty('presentation/step',a.toString());},getStep:function(){var a=dizmo.publicStorage().getProperty('presentation/step');a=parseInt(a);if(isNaN(a))return 0;return a;},firstStep:function(){var a=this;a.setStep(1);},previousStep:function(){var a=this;var b=dizmo.publicStorage().getProperty('presentation/step');b=parseInt(b);if(isNaN(b))throw {'name':'NotANumberError','message':'The step property does not seem to be a number!'};if(b-1<=1){a.firstStep();return;}a.setStep(--b);},nextStep:function(){var a=this;var b=dizmo.publicStorage().getProperty('presentation/step');var c=dizmo.publicStorage().getProperty('presentation/totalSteps');b=parseInt(b);c=parseInt(c);if(isNaN(b)||isNaN(c))throw {'name':'NotANumberError','message':'The step property does not seem to be a number!'};if(b+1>=c){a.lastStep();return;}a.setStep(++b);},lastStep:function(){var a=this;var b=dizmo.publicStorage().getProperty('presentation/totalSteps');b=parseInt(b);if(isNaN(b))throw {'name':'NotANumberError','message':'The total steps property does not seem to be a number!'};a.setStep(b);},startAnimation:function(){dizmo.publicStorage().setProperty('presentation/animationRunning','true');},stopAnimation:function(){dizmo.publicStorage().setProperty('presentation/animationRunning','false');},globalTimerRunning:function(){var a=dizmo.publicStorage().getProperty('presentation/globalTimerRunning');if(a==='true')return true;else return false;},startGlobalTimer:function(){if(dizmo.publicStorage().getProperty('presentation/hasGlobalTimer')!=='true'){console.log('You have to enable the global timer first!');return;}dizmo.publicStorage().setProperty('presentation/globalTimerRunning','true');},stopGlobalTimer:function(){if(dizmo.publicStorage().getProperty('presentation/hasGlobalTimer')!=='true'){console.log('You have to enable the global timer first!');return;}dizmo.publicStorage().setProperty('presentation/globalTimerRunning','false');},setGlobalTimer:function(a){if(typeof a!=='boolean')a=false;if(a)dizmo.publicStorage().setProperty('presentation/hasGlobalTimer','true');else dizmo.publicStorage().setProperty('presentation/hasGlobalTimer','false');},hasGlobalTimer:function(){value=dizmo.publicStorage().getProperty('presentation/hasGlobalTimer');if(value==='true')return true;else return false;}}}});Class('DizmoHelper.Presentation.RemoteController',{has:{dizmo:{is:'rw',init:null},totalSteps:{is:'rw',init:0},step:{is:'rw',init:0,getterName:'getStep',setterName:'setStep'},animationChangedCallback:{is:'rw',init:null},globalTimerStoppedCallback:{is:'rw',init:null},globalTimerStartedCallback:{is:'rw',init:null}},after:{initialize:function(a){var b=this;if(typeof a.dizmo!=='object'){console.log('You need to provide a dizmo object.');return null;}if(typeof a.onAnimationChanged==='function')b.setAnimationChangedCallback(a.onAnimationChanged);if(typeof a.onGlobalTimerStarted==='function')b.setGlobalTimerStartedCallback(a.onGlobalTimerStarted);if(typeof a.onGlobalTimerStopped==='function')b.setGlobalTimerStoppedCallback(a.onGlobalTimerStopped);b.setDizmo(a.dizmo);totalSteps=b.getDizmo().publicStorage().getProperty('presentation/totalSteps');if(typeof totalSteps!=='undefined'){totalSteps=parseInt(totalSteps);if(!isNaN(totalSteps))b.setTotalSteps(totalSteps);}step=b.getDizmo().publicStorage().getProperty('presentation/step');if(typeof step!=='undefined'){step=parseInt(step);if(!isNaN(step))b.setStep(step);}b.initEvents();}},methods:{initEvents:function(){var a=this;var b=a.getDizmo();var c=b.publicStorage();c.subscribeTo('presentation/totalSteps',function(b,c,d){steps=parseInt(c);if(isNaN(steps))a.setTotalSteps(0);a.setTotalSteps(steps);});c.subscribeTo('presentation/step',function(b,c,d){step=parseInt(c);if(isNaN(step))a.step=0;a.step=step;});c.subscribeTo('presentation/animationRunning',function(b,c,d){var e=a.getAnimationChangedCallback();if(typeof d==='undefined')d='false';if(d!=='true'&&d!=='false'){d='false';return;}if(d===c)return;if(c==='true'){if(typeof e==='function')e.call(a,'finished');}else if(c==='false'){if(typeof e==='function')e.call(a,'started');}else console.log('The set animation value is wrong. It should be either true or false.');});c.subscribeTo('presentation/globalTimerRunning',function(b,c,d){if(!a.hasGlobalTimer()){console.log('You have to enable the global timer first!');return;}var e=a.getGlobalTimerStoppedCallback();var f=a.getGlobalTimerStartedCallback();if(typeof d==='undefined')d='false';if(d!=='true'&&d!=='false'){d='false';return;}if(d===c)return;if(c==='false'){if(typeof e==='function')e.call(a);}else if(c==='true'){if(typeof f==='function')f.call(a);}else{console.log('The global timer flag value is wrong. It should be either true or false.');return;}});},setStep:function(a){var b=this;a=parseInt(a);if(isNaN(a)){console.log('The provided step parameter is neither a number nor a valid string.');return;}if(a>b.getTotalSteps()){console.log('The provided step is bigger than the total steps accepter by this dizmo');return;}b.getDizmo().publicStorage().setProperty('presentation/step',a.toString());b.step=a;},getStep:function(){var a=this;return a.step;},firstStep:function(){var a=this;var b=a.getDizmo();var c=a.getStep();if(c===0)return;a.setStep(1);},previousStep:function(){var a=this;var b=a.getDizmo();var c=a.getStep();if(c-1===0){a.firstStep();return;}a.setStep(--c);},nextStep:function(){var a=this;var b=a.getDizmo();var c=a.getStep();var d=a.getTotalSteps();if(c+1===d){a.lastStep();return;}a.setStep(++c);},lastStep:function(){var a=this;var b=a.getDizmo();var c=a.getStep();var d=a.getTotalSteps();if(c===d)return;a.setStep(d);},stopGlobalTimer:function(){var a=this;a.getDizmo().publicStorage().setProperty('presentation/globalTimerRunning','false');},startGlobalTimer:function(){var a=this;a.getDizmo().publicStorage().setProperty('presentation/globalTimerRunning','true');},hasGlobalTimer:function(){var a=this;var b=a.getDizmo().publicStorage().getProperty('presentation/hasGlobalTimer');if(b==='true')return true;else return false;},globalTimerRunning:function(){var a=this;var b=a.getDizmo().publicStorage().getProperty('presentation/globalTimerRunning');if(b==='true')return true;else return false;}}});Class('DizmoHelper.Utils',{my:{methods:{getDizmoPosition:function(a,b){if(typeof b!=='object')throw {name:'mustBeADizmoObject',message:'You need to provide a dizmo object, as provided by onDock, onUndock or canDock.'};try{var c=a.getAttribute('geometry/x');var d=c-a.getAttribute('geometry/width');var e=a.getAttribute('geometry/y');var f=e+a.getAttribute('geometry/height')+40;}catch(g){throw {name:'mustBeADizmoObject',message:'You need to provide a dizmo object, as provided by onDock, onUndock or canDock.'};}try{var h=b.getAttribute('geometry/x');var i=h-b.getAttribute('geometry/width');var j=b.getAttribute('geometry/y');var k=j+b.getAttribute('geometry/height')+40;}catch(g){throw {name:'mustBeADizmoObject',message:'You need to provide a dizmo object, as provided by onDock, onUndock or canDock.'};}if(h<=d)return 'left';if(i>=c)return 'right';if(k<=e)return 'top';if(j>=f)return 'bottom';},randomString:function(a,b){if(jQuery.type(a)!=='number')throw 'Length is not a number';if(a<1)throw 'Length must be greater or equal to 1';if(jQuery.type(b)!=='boolean')if(jQuery.type(b)==='undefined')b=false;else throw 'Nodupes must be either a boolean or undefined';var c='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';var d='';var e='';if(b&&a>c.length)throw 'Length must be smaller than '+c.length+' if used with nodupes.';do{var f=Math.floor(Math.random()*c.length);var g=c.charAt(f);if(b===true){var h=(e.indexOf(g)!==-1);if(h===true)continue;e+=g;}d+=g;}while(d.length<a);return d;}}}});Class('DizmoHelper.DockingManager',{my:{has:{dockedDizmos:{is:'rw',init:[],getterName:'getDockedDizmos'},onDockCallback:{is:'rw',init:null,setterName:'onDock'},onUndockCallback:{is:'rw',init:null,setterName:'onUndock'},canDockCallback:{is:'rw',init:null,setterName:'canDock'},initialized:{is:'rw',init:false},directional:{is:'rw',init:false,setterName:'setDirectional'}},methods:{init:function(a){var b=this;if(b.getInitialized())return;if(typeof a==='object')if(typeof a.directional==='boolean')b.setDirectional(a.directional);dizmo.onDock(function(a){var c=b.getOnDockCallback();var d=DizmoHelper.Utils.getDizmoPosition(dizmo,a);var e=b.getDizmoIO(d);b.addDockedDizmo(a,d);if(typeof c==='function')c.call(b,a,d,e);});dizmo.onUndock(function(a){var c=b.getOnUndockCallback();var d=DizmoHelper.Utils.getDizmoPosition(dizmo,a);var e=b.getDizmoIO(d);b.removeDockedDizmo(a);if(typeof c==='function')c.call(b,a,d,e);});dizmo.canDock(function(a){var c=b.getCanDockCallback();var d=DizmoHelper.Utils.getDizmoPosition(dizmo,a);var e=b.getDizmoIO(d);if(!b.canDockOnSide(d))return false;if(c===true)return true;else if(c===false)return false;else if(typeof c==='function'){var f=c.call(b,a,d,e);if(typeof f!=='boolean')return false;else return f;}});b.setInitialized(true);},getDizmoIO:function(a){var b=this;if(!b.getDirectional())return undefined;if(a==='top'||a==='left')return 'input';else return 'output';},canDockOnSide:function(a){var b=this;if(!b.getDirectional())return true;var c=b.getDockedDizmos();for(var d=0;d<c.length;d++){if(c[d].side===a)return false;if((c[d].side==='top'||c[d].side==='bottom')&&(a==='left'||a==='right'))return false;if((c[d].side==='left'||c[d].side==='right')&&(a==='top'||a==='bottom'))return false;}return true;},addDockedDizmo:function(a,b){var c=this;var d=c.getDockedDizmos();for(var e=0;e<d.length;e++)if(d[e].dizmo.identifier===a.identifier)return;d.push({'dizmo':a,'side':b});c.setDockedDizmos(d);},removeDockedDizmo:function(a){var b=this;var c=undefined;var d=b.getDockedDizmos();for(var e=0;e<d.length;e++)if(d[e].dizmo.identifier===a.identifier)c=e;if(typeof c!=='undefined'){d.splice(c,1);b.setDockedDizmos(d);}},canDock:function(a){var b=this;if(typeof a==='boolean'||typeof a==='function')b.canDockCallback=a;else{console.log('Provide either a boolean or a function!');return;}},onDock:function(a){var b=this;if(typeof a!=='function'){console.log('Provide a function as the onDock callback!');return;}b.onDockCallback=a;},onUndock:function(a){var b=this;if(typeof a!=='function'){console.log('Provide a function as the onUndock callback!');return;}b.onUndockCallback=a;},getDockedDizmos:function(){var a=this;return a.dockedDizmos;},setDirectional:function(a){var b=this;if(typeof a==='boolean')b.directional=a;else b.directional=false;}}}});